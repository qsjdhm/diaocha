<!DOCTYPE html>
<html lang="en">
<head>
    <title>会议筹办申请</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
    <meta name="renderer" content="webkit" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="format-detection" content="telephone=no" />
    <link rel="stylesheet" href="js/lib/mui/css/mui.min.css" />
    <link rel="stylesheet" href="js/lib/mui/css/mui.picker.min.css">
    <link rel="stylesheet" href="js/lib/mui/css/mui.picker.css">
    <link rel="stylesheet" href="js/lib/mui/css/mui.poppicker.css">
    <link rel="stylesheet" href="css/app.css" />
    <style>
        .container {
            width: 100%;
            height: auto;
            overflow-y: auto;
            overflow-x: hidden;
            background-color: rgba(254,223,223,1);
        }
        
        .container .top {
            width: 100%;
            padding: 8px 0 0 0;
            background-color: rgba(253,96,77,1);
        }

        /* 会议申请图片 */
        .container .top .apply-metting {
            height: 383px;
            margin: 0 10px 36px 10px;
            background-image: url('./i/hysq/apply_background.png');
            background-size: 100% 100%;
            background-repeat: no-repeat;
            
        }

        /* 填写申请 */
        .container .top .write-apply {
            height: 285px;
            margin: 36px 10px 0 10px;
            background-color: #FFFFFF;
            position: relative;
            padding: 20px;
        }
        .container .top .write-apply .title {
            width: 169px;
            height: 58px;
            background-image: url('./i/hysq/apply_write.png');
            position: absolute;
            left: 0;
            top: -25px;
        }
        .container .top .write-apply .company {
            padding-top: 25px;
            border-bottom: 1px solid rgba(216,216,216,0.4);
        }
        .container .top .write-apply .company input {
            border: none;
            height: 38px;
            font-size: 14px;
            color: #3D3D3D;
            padding: 0;
            margin: 0;
        }
        .container .top .write-apply .company input::-webkit-input-placeholder {
            color:rgba(0,0,0,0.2);
        }
        .container .top .write-apply .meeting-two {
            padding-top: 15px;
            border-bottom: 1px solid rgba(216,216,216,0.4);
            overflow: hidden;
        }
        .container .top .write-apply .meeting-two .conference-size {
            width: 35%;
            float: left;
        }
        .container .top .write-apply .meeting-two .conference-size #meetingLocal {
            font-size: 12px;
            padding-left: 0;
            padding-right: 0;
            width: 100%;
            text-align: left;
            border: none;
            color:rgba(0,0,0,0.2);
        }
        .container .top .write-apply .meeting-two .head {
            opacity: 0.4;
            width: 48px;
            height: 18px;
            font-size: 12px;
            font-family: SourceHanSansCN-Normal,SourceHanSansCN;
            font-weight: 400;
            color: rgba(46,46,71,0.4);
            line-height: 18px;
        }
        .container .top .write-apply .meeting-two select {
            padding: 5px 0 10px 0;
            margin: 0;
        } 
        .container .top .write-apply .meeting-two select option {
            width:24px;
            height:18px;
            font-size:12px;
            font-family:SourceHanSansCN-Bold,SourceHanSansCN;
            font-weight:bold;
            color:rgba(46,46,71,1);
            line-height:18px;
        }
        .container .top .write-apply .meeting-two .and {
            width:25px;
            height:18px;
            font-size:12px;
            font-family:SourceHanSansCN-Normal,SourceHanSansCN;
            font-weight:400;
            color:rgba(171,171,181,1);
            line-height:18px;
            float: left;
            margin-top: 15px;
        }
        .container .top .write-apply .meeting-two .meeting-num {
            float: left;
            margin-left: 19%;
        }
        .container .top .write-apply .meeting-two .meeting-num .num {
            width:48px;
            height:18px;
            font-size:12px;
            font-family:SourceHanSansCN-Normal,SourceHanSansCN;
            font-weight:400;
            color:rgba(46,46,71,0.4);
            line-height:18px;
        }
        .container .top .write-apply .meeting-two .meeting-num #mettingNum {
            font-size: 12px;
            padding-left: 0;
            padding-right: 0;
            width: 100%;
            text-align: left;
            border: none;
            color:rgba(0,0,0,0.2);
        }
        .container .top .write-apply .meeting-time {
            padding-top: 15px;
            border-bottom: 1px solid rgba(216,216,216,0.4);
            overflow: hidden;
        }
        .container .top .write-apply .meeting-time  .meeting-duration {
            width: 35%;
            float: left;
        }
        .container .top .write-apply .meeting-time .meeting-duration .duration  {
            opacity: 0.4;
            width: 48px;
            height: 18px;
            font-size: 12px;
            font-family: SourceHanSansCN-Normal,SourceHanSansCN;
            font-weight: 400;
            color: rgba(46,46,71,0.4);
            line-height: 18px;
        }
        .container .top .write-apply .meeting-time  .meeting-duration #mettingDuration {
            font-size: 12px;
            padding-left: 0;
            padding-right: 0;
            width: 100%;
            text-align: left;
            border: none;
            color:rgba(0,0,0,0.2);
        }
        .container .top .write-apply .meeting-time select {
            padding: 5px 0 10px 0;
            margin: 0;
        } 
        .container .top .write-apply .meeting-time select option {
            width:24px;
            height:18px;
            font-size:12px;
            font-family:SourceHanSansCN-Bold,SourceHanSansCN;
            font-weight:bold;
            color:rgba(46,46,71,1);
            line-height:18px;
        }
        .container .top .write-apply .meeting-time .and {
            width:25px;
            height:18px;
            font-size:12px;
            font-family:SourceHanSansCN-Normal,SourceHanSansCN;
            font-weight:400;
            color:rgba(171,171,181,1);
            line-height:18px;
            float: left;
            margin-top: 15px;
        }
        .container .top .write-apply .meeting-time .start-time {
            float: left;
            margin-left: 19%;
            width: 35%;
        }
        .container .top .write-apply .meeting-time .start-time .time {
            width:48px;
            height:18px;
            font-size:12px;
            font-family:SourceHanSansCN-Normal,SourceHanSansCN;
            font-weight:400;
            color:rgba(46,46,71,0.4);
            line-height:18px;
        }
        .container .top .write-apply .meeting-time .start-time #startTime {
            font-size: 12px;
            padding-left: 0;
            padding-right: 0;
            width: 100%;
            text-align: left;
            border: none;
            color:rgba(0,0,0,0.2);
        }
        .container .top .write-apply  .budget {
            padding-top: 15px;
        }
        .container .top .write-apply  .budget input {
            width: 100%;
            height: 18px;
            font-size: 14px;
            font-family: SourceHanSansCN-Normal,SourceHanSansCN;
            font-weight: 400;
            line-height: 18px;
            border: none;
            padding: 0;
        }
        .container .top .write-apply  .budget input::-webkit-input-placeholder {
            color:rgba(0,0,0,0.2);
        }
        /* 会议类型 */
        .container .top .meeting-type {
            /* width:375px; */
            height:auto;
            background:rgba(254,223,223,1);
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }
        .container .top .meeting-type .type {
            width: 169px;
            height: 9px;
            background-image: url('./i/hysq/type.png');
            position: absolute;
            background-repeat: no-repeat;
            left: 33px;
            top: 30px;
        }
        .container .top .meeting-type .type-font {
            width: 109px;
            height: 37px;
            background-image: url('./i/hysq/type-font.png');
            position: absolute;
            background-repeat: no-repeat;
            left: 10px;
            top: 57px;
        }
        .container .top .meeting-type .content {
            /* width: 283px; */
            /* height: 272px; */
            background: rgba(255,255,255,1);
            box-shadow: 5px 4px 23px 0px rgba(250,118,99,0.4);
            margin: 109px 82px 0px 10px;
            position: relative;
        }
       
        .container .top .meeting-type .content .metting-item-check{
            position: absolute;
            width: 75px;
            height: 42px;
            background:rgba(248,122,107,1);
            /* border-radius: 10px; */
            right: -75px;
            text-align: center;
            line-height: 42px;
            color: #fff;
            border-radius: 0 15px 15px 0;
            top: 10px;
            font-size: 14px;
        }
        .container .top .meeting-type .content .metting-type-retail .theme-pack {
            height: auto;
        }
        .stripes {
            background-color: #fbf9f8!important;
        }
        .container .top .meeting-type .content .metting-type-retail .theme-pack .theme-item {
            background: rgba(255,255,255,1);
            line-height: 60px;
            display: flex;
        }
        .container .top .meeting-type .content .metting-type-retail .theme-pack span {
            font-size: 14px;
            font-family: SourceHanSansCN-Medium,SourceHanSansCN;
            font-weight: 500;
            color: rgba(0,0,0,0.8);
            margin-left: 20px;
            margin-right: 10px;
            flex: 1;
        }
        .container .top .meeting-type .content .metting-type-retail .theme-pack .check {
            width:  15px;
            height: 15px;
            background-image: url('./i/rccx/check.png');
            background-repeat: no-repeat;
            background-size: 100% 100%;
            margin: 22px 22px 0px 0px;
        }
        .container .top .meeting-type .content .metting-type-retail .proposal p {
            font-size: 14px;
            font-family: SourceHanSansCN-Medium,SourceHanSansCN;
            font-weight: 500;
            color: rgba(0,0,0,0.8);
            margin: 20px;
        } 
        .container .top .meeting-type .content .metting-type-retail .proposal input {
            font-size: 14px;
            font-family: SourceHanSansCN-Normal,SourceHanSansCN;
            font-weight: 400;
            border: navajowhite;
            text-indent: 5px;
            margin-bottom: 0px;
        }
        .container .top .meeting-type .content .metting-type-retail .proposal input::-webkit-input-placeholder {
            color:rgba(0,0,0,0.2);
        }
        .container .top .meeting-type .content .metting-type-retail .proposal .line {
            height: 1px;
            border-bottom: 1px solid #eee;
            margin: 0 15px;
        }
        .container .top .meeting-type .content .metting-type-retail .point {
            background-image: url('./i/hysq/point.png');
            height: 9px;
            background-repeat: no-repeat;
            margin: 30px 0 0 191px;
            padding-bottom: 20px;
        }
        .container .top .meeting-type .demand {
            margin-top: 40px;
        }
        .container .top .meeting-type .icon {
            background-image: url('./i/hysq/demand.png');
            height: 41px;
            background-repeat: no-repeat;
            margin-left: 10px;
        }
        .container .top .meeting-type .item {
            height: 74px;
            background: rgba(255,255,255,1);
            box-shadow: 0px 0px 12px 0px rgba(0,0,0,0.04);
            margin: 0 10px;
            line-height: 74px;
            display: flex;
            flex-direction: row;
        }
        .container .top .meeting-type .item span {
            font-size: 12px;
            font-family: SourceHanSansCN-Bold,SourceHanSansCN;
            font-weight: bold;
            color: rgba(46,46,71,1);
            margin-left: 24px;
        }
        .container .top .meeting-type .item #serverType {
            font-size: 12px;
            padding-left: 20px;
            padding-right: 0;
            width: 100%;
            text-align: left;
            border: none;
            color:rgba(0,0,0,0.2);
            flex: 1;
        }
        .container .top .meeting-type .confirm-btn {
            text-align: center;
            line-height: 46px;
            margin: 28px 75px 30px 75px;
            width: 226px;
            height: 46px;
            background: rgba(250,150,0,1);
            border-radius: 24px;
            font-size:14px;
            font-family:SourceHanSansCN-Bold,SourceHanSansCN;
            font-weight:bold;
            color:rgba(250,250,250,1);
        }

        .checked {
            background-image: url('./i/rccx/checked.png') !important;
        }

        .metting-item-checked {
            background: linear-gradient(161deg,rgba(248,174,0,1) 0%,rgba(254,206,0,1) 100%) !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="top">
            <!-- 会议申请图片 -->
            <div class="apply-metting"></div>
            <!-- 填写申请 -->
            <div class="write-apply">
                <div class="title"></div>
                <div class="company">
                    <input
                        id="conpanyName"
                        type="text"
                        placeholder="填写申办公司名称（必填）"
                    />
                </div>
                <div class="meeting-two">
                    <div class="conference-size">
                        <span class="head">会议地点</span>
                        <button
                            type="button"
                            id="meetingLocal">
                            请选择地点
                        </button>
                    </div>
                    <div class="and">AND</div>
                    <div class="meeting-num">
                        <span class="num">会议人数</span>
                        <button
                            type="button"
                            id="mettingNum">
                            请选择人数
                        </button>
                    </div>
                </div>
                <div class="meeting-time">
                    <div class="meeting-duration">
                        <span class="duration">会议时长</span>
                        <button
                            type="button"
                            id="mettingDuration">
                            请选择时长
                        </button>
                    </div>
                    <div class="and">AND</div>
                    <div class="start-time">
                        <span class="time">开始时间</span>
                        <button
                            type="button"
                            id="startTime">
                            请选择时间
                        </button>
                    </div>
                </div>
                <div class="budget">
                    <input
                        id="budgetNum"
                        type="number"
                        placeholder="请输入您的预算（万元）"
                    />
                </div>

            </div>
            <!-- 会议类型 -->
            <div class="meeting-type">
                <div class="type"></div>
                <div class="type-font"></div>
                <div class="content">
                    <div class="metting-item-pack">
                    </div>
                    <div class="metting-type-retail">
                        <div class="theme-pack">
                        </div>
                        <div class="proposal">
                           <p>您的建议主题</p>
                           <input
                                id="otherTheme"
                                type="text"
                                placeholder="请输入"
                            />
                            <div class="line"></div>
                        </div>
                        <div class="point"></div>
                    </div>
                </div>
                <!-- 您的需求项 -->
                <div class="demand">
                    <div class="icon"></div>
                    <div class="item">
                        <span>请选择</span>
                        <button
                            type="button"
                            id="serverType">
                            请选择需求项
                        </button>
                    </div>
                </div>
                <!-- 提交 -->
                <div id="submit" class="confirm-btn">提交</div>
            </div>
        </div>
    </div>

    <!-- 通用类库 -->
    <script src="js/lib/zepto.js"></script>
    <script src="js/lib/zepto.touch.js"></script>
    <script src="js/lib/fastclick.js"></script>
    <script src="js/lib/mui/js/mui.min.js"></script>
    <script src="js/lib/mui/js/city.data.js"></script>
    <script src="js/lib/mui/js/mui.picker.min.js"></script>

    <script>
	    // 首先取消js在客户端的点击事件300毫秒延迟
	    FastClick.attach(document.body);

	    // 初始化加载更多
	    mui.init({
		    swipeBack: true //启用右滑关闭功能
	    });


        getTypeList()

        // 获取列表
        function getTypeList () {
	        $.ajax({
		        url: "https://groundpushbff.kangyw.com/meetingtype/list",
		        type: 'POST',
		        dataType: 'json',
		        contentType: 'application/json',
		        data: JSON.stringify({}),
		        success: function(result) {
		        	console.info(result)
			        if (result.code === 'K-000000') {
                        var html = '';
				        $('.metting-item-pack').empty();
				        for (var i=0,len=result.context.meetingTypeVOList.length; i<len; i++) {
				        	if (i==0) {
						        html += '<div id="'+result.context.meetingTypeVOList[i].id+'" class="metting-item-checked metting-item-check">'+result.context.meetingTypeVOList[i].meetingTypeName+'</div>'
                            } else {
				        		var top = i*60+10;
						        html += '<div id="'+result.context.meetingTypeVOList[i].id+'" style="top:'+top+'px" class="metting-item-check">'+result.context.meetingTypeVOList[i].meetingTypeName+'</div>'
                            }
                        }
				        $('.metting-item-pack').append(html)
				        // 获取此分类下主题列表
				        getThemeList(result.context.meetingTypeVOList[0].id, result.context.meetingTypeVOList[0].meetingTypeName)
			        } else {
				        mui.alert(result.msg, '平台服务', function () {
					        console.info('你刚关闭了警告框');
				        });
			        }
		        },
		        error: function() {
			        mui.alert('获取会议类型出错！', '平台服务', function() {
				        console.info('你刚关闭了警告框');
			        });
		        }
	        });
        }

        // 获取主题列表
        function getThemeList (typeId, typeName) {
	        $.ajax({
		        url: "https://groundpushbff.kangyw.com/meetingtypetheme/list",
		        type: 'POST',
		        dataType: 'json',
		        contentType: 'application/json',
		        data: JSON.stringify({
			        meetingTypeId: typeId
                }),
		        success: function(result) {
			        console.info(result)
			        if (result.code === 'K-000000') {
			        	$('.theme-pack').empty();
				        var html = '';
				        for (var i=0,len=result.context.meetingTypeThemeVOList.length; i<len; i++) {
					        if (i%2 == 0) {
                                html += '<div class="theme-item">'
						        html += '   <span>'+result.context.meetingTypeThemeVOList[i].meetingTypeName+'</span>'
						        html += '   <div id="'+result.context.meetingTypeThemeVOList[i].id+'" typeId="'+result.context.meetingTypeThemeVOList[i].meetingTypeId+'" typeName="'+typeName+'" name="'+result.context.meetingTypeThemeVOList[i].meetingTypeName+'" class="check"></div>'
						        html += '</div>'
					        } else {
						        html += '<div class="theme-item stripes">'
						        html += '   <span>'+result.context.meetingTypeThemeVOList[i].meetingTypeName+'</span>'
						        html += '   <div id="'+result.context.meetingTypeThemeVOList[i].id+'" typeId="'+result.context.meetingTypeThemeVOList[i].meetingTypeId+'" typeName="'+typeName+'" name="'+result.context.meetingTypeThemeVOList[i].meetingTypeName+'" class="check"></div>'
						        html += '</div>'
					        }
				        }
				        $('.theme-pack').append(html)
			        } else {
				        mui.alert(result.msg, '平台服务', function () {
					        console.info('你刚关闭了警告框');
				        });
			        }
		        },
		        error: function() {
			        mui.alert('获取会议类型出错！', '平台服务', function() {
				        console.info('你刚关闭了警告框');
			        });
		        }
	        });
        }

        // 会议地点选择器
        $('#meetingLocal').on('click', function () {
	        var picker = new mui.PopPicker({layer: 2});
	        picker.setData(cityData);
	        picker.show(function (res) {
		        $('#meetingLocal').text(res[1].text);
		        $('#meetingLocal').css('color', 'rgba(46,46,71,1)');
	        })
        })
        // 会议人数选择器
        $('#mettingNum').on('click', function () {
            var picker = new mui.PopPicker();
            var mockData = [
                {value: 0, text: '10-30'},
                {value: 1, text: '30-60'},
                {value: 2, text: '60-100'},
                {value: 3, text: '100-200'},
                {value: 4, text: '200-300'},
                {value: 5, text: '300-500'},
                {value: 6, text: '500-1000'},
                {value: 7, text: '1000+'},
            ];
            picker.setData(mockData);
            picker.show(function (res) {
                $('#mettingNum').text(res[0].text);
                $('#mettingNum').css('color', 'rgba(46,46,71,1)');
            })
        })
        // 会议时长选择器
        $('#mettingDuration').on('click', function () {
            var picker = new mui.PopPicker();
            var mockData = [
                {value: 0, text: '半天'},
                {value: 1, text: '一天'},
                {value: 2, text: '两天'},
                {value: 3, text: '三天以上'}
            ];
            picker.setData(mockData);
            picker.show(function (res) {
                $('#mettingDuration').text(res[0].text);
                $('#mettingDuration').css('color', 'rgba(46,46,71,1)');
            })
        })
        // 开始时间选择器
        $('#startTime').on('click', function () {
            var picker = new mui.DtPicker({ type: 'date' });
            picker.show(function (res) {
                $('#startTime').text(res.text);
                $('#startTime').css('color', 'rgba(46,46,71,1)');
            })
        })
        // 需求项选择器
        $('#serverType').on('click', function () {
            var picker = new mui.PopPicker();
            var mockData = [
                {value: 0, text: '开会'},
                {value: 1, text: '开会+用餐'},
                {value: 2, text: '开会+住宿'},
                {value: 3, text: '开会+用餐+住宿'}
            ];
            picker.setData(mockData);
            picker.show(function (res) {
                $('#serverType').text(res[0].text);
	            $('#serverType').attr('typeId', res[0].value);
                $('#serverType').css('color', 'rgba(46,46,71,1)');
            })
        })
        // 会议类型tab选中
        $('.metting-item-check').live('click', function () {
            $('.metting-item-check').removeClass('metting-item-checked');
            $(this).addClass('metting-item-checked');
	        getThemeList($(this).attr('id'), $(this).html())
        })
        // 会议类型单选选中
        $('.check').live('click', function () {
        	if ($(this).hasClass('checked')) {
		        $(this).removeClass('checked');
            } else {
		        $('.check').removeClass('checked');
		        $(this).addClass('checked');
            }
        })

	    $('#submit').on('click', function () {
		    var conpanyName = '';
		    var meetingLocal = '';
		    var mettingDuration = '';
		    var mettingNum = '';
		    var startTime = '';
		    var budgetNum = '';
		    var typeName = '';
		    var meetingTheme = '';
            var serverType = '';

		    if ($.trim($('#conpanyName').val()) == '') {
			    mui.alert('请输入申办公司名称', '平台服务', function () {});
			    return false
		    } else {
			    conpanyName = $.trim($('#conpanyName').val())
		    }
		    if ($.trim($('#meetingLocal').html()) == '请选择地点') {
			    mui.alert('请选择地点', '平台服务', function () {});
			    return false
		    } else {
			    meetingLocal = $('#meetingLocal').html()
		    }
		    if ($.trim($('#mettingDuration').html()) == '请选择时长') {
			    mui.alert('请选择时长', '平台服务', function () {});
			    return false
		    } else {
			    mettingDuration = $('#mettingDuration').html()
		    }
		    if ($.trim($('#mettingNum').html()) == '请选择人数') {
			    mui.alert('请选择人数', '平台服务', function () {});
			    return false
		    } else {
			    mettingNum = $('#mettingNum').html()
		    }
		    if ($.trim($('#startTime').html()) == '请选择时间') {
			    mui.alert('请选择时间', '平台服务', function () {});
			    return false
		    } else {
			    startTime = $('#startTime').html()
		    }
		    if ($.trim($('#budgetNum').val()) == '') {
			    mui.alert('请输入您的预算', '平台服务', function () {});
			    return false
		    } else {
			    budgetNum = $.trim($('#budgetNum').val())
		    }
		    if ($('.checked').attr('name') == undefined && $('#otherTheme').val() == '') {
			    mui.alert('请选择会议主题或输入您的建议主题', '平台服务', function () {});
			    return false
            } else {
			    typeName = $('.checked').attr('typeName')
			    var theme = $('.checked').attr('name')
			    var otherTheme = $('#otherTheme').val()
			    if (theme == undefined) {
				    if (otherTheme == '') {
					    meetingTheme = ''
				    } else {
					    meetingTheme = otherTheme
				    }
			    } else {
				    if (otherTheme != '') {
					    meetingTheme = theme + ';' + otherTheme
				    } else {
					    meetingTheme = theme
                    }
			    }
            }
		    if ($.trim($('#serverType').html()) == '请选择需求项') {
			    mui.alert('请选择需求项', '平台服务', function () {});
			    return false
		    } else {
			    serverType = $('#serverType').attr('typeId')
		    }
		    window.sessionStorage.setItem('cbInfo', JSON.stringify({
			    conpanyName: conpanyName,
			    meetingLocal: meetingLocal,
			    mettingDuration: mettingDuration,
			    mettingNum: mettingNum,
			    startTime: startTime,
			    budgetNum: budgetNum,
			    typeName: typeName,
			    meetingTheme: meetingTheme,
			    serverType: serverType,
		        contentType: 2
		    }))
		    window.location.href = 'hysqbf.html?time='+new Date().getTime();
	    })
    </script>
</body>
</html>